<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·é¦–é¡µ Â· å¿ƒç†å…³æ€€å·¥å…·é›†</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/css/home.css">
    <style>
        /* è¡¥å……ä¾§è¾¹æ æ ·å¼ */
        .sidebar-item {
            @apply flex items-center gap-3 px-4 py-3 rounded-xl text-gray-700 hover:bg-indigo-50 hover:text-indigo-700 transition cursor-pointer;
        }
        .sidebar-item.active {
            @apply bg-indigo-100 text-indigo-800 font-medium;
        }
        .settings-form input {
            @apply w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500 outline-none;
        }

        /* ========== æ‰‹æœºç«¯å“åº”å¼è°ƒæ•´ ========== */
        @media (max-width: 768px) {
            /* çˆ¶å®¹å™¨æ”¹ä¸ºçºµå‘æ’åˆ— */
            .flex.min-h-screen {
                flex-direction: column;
            }
            /* ä¾§è¾¹æ å®½åº¦100%ï¼Œä¸å†å›ºå®š */
            aside.w-72 {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                padding: 1rem;
            }
            /* å³ä¾§å†…å®¹åŒºå®½åº¦100% */
            main.flex-1 {
                width: 100%;
                padding: 1rem;
            }
            /* å·¥å…·å¡ç‰‡æ”¹ä¸ºæ¯è¡Œä¸€ä¸ª */
            .grid.md\:grid-cols-3 {
                grid-template-columns: 1fr;
            }
            /* ä¾§è¾¹æ å†…éƒ¨å…ƒç´ é—´è·å¯é€‚å½“ç¼©å° */
            .sidebar-item {
                padding: 0.5rem 1rem;
            }
        }
        /* ========== å“åº”å¼è°ƒæ•´ç»“æŸ ========== */
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex min-h-screen">
        <!-- å·¦ä¾§ä¾§è¾¹æ  -->
        <aside class="w-72 bg-white shadow-lg p-6 flex flex-col border-r border-gray-200">
            <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
            <div class="flex items-center gap-4 mb-8">
                <div class="w-14 h-14 rounded-full bg-indigo-100 flex items-center justify-center text-3xl text-indigo-600">
                    ğŸ‘¤
                </div>
                <div>
                    <div class="text-xl font-bold text-gray-800" id="usernameDisplay">åŠ è½½ä¸­...</div>
                    <div class="text-sm text-gray-500">æ™®é€šç”¨æˆ·</div>
                </div>
            </div>

            <!-- è®¾ç½®æŒ‰é’® -->
            <div class="sidebar-item mb-4" id="settingsBtn">
                <span class="text-xl">âš™ï¸</span>
                <span>è®¾ç½®</span>
            </div>

            <!-- ========== æ–°å¢è¿”å›å¯¹è¯æŒ‰é’® ========== -->
            <div class="sidebar-item mb-4" id="backToIndexBtn">
                <span class="text-xl">ğŸ’¬</span>
                <span>è¿”å›å¯¹è¯</span>
            </div>
            <!-- ========== æ–°å¢ç»“æŸ ========== -->

            <!-- å·¥å…·åˆ—è¡¨å¯¼èˆª -->
            <div class="mt-4 border-t pt-4">
                <div class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">å·¥å…·åˆ—è¡¨</div>
                <div class="sidebar-item active" id="toolsNavBtn">
                    <span class="text-xl">ğŸ§°</span>
                    <span>å¿ƒç†å…³æ€€å·¥å…·é›†åˆ</span>
                </div>
                <!-- å¯æ‰©å±•å…¶ä»–å·¥å…·ï¼Œæš‚æ—¶åªæ”¾ä¸€ä¸ª -->
            </div>

            <!-- æ¯æ—¥ç­¾åˆ°æŒ‰é’® -->
            <div class="mt-auto pt-6">
                <button id="signinBtn" class="w-full bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold py-3 px-4 rounded-xl shadow-md hover:shadow-lg transform hover:scale-[1.02] transition flex items-center justify-center gap-2">
                    <span class="text-xl">ğŸ“…</span>
                    æ¯æ—¥ç­¾åˆ°
                </button>
            </div>
        </aside>

        <!-- å³ä¾§å†…å®¹åŒº -->
        <main class="flex-1 p-8 overflow-y-auto">
            <!-- å·¥å…·å¡ç‰‡å®¹å™¨ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ -->
            <div id="toolsContainer">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">å¿ƒç†å…³æ€€å·¥å…·é›†</h2>
                <p class="text-gray-600 mb-8">é€‰æ‹©ä»¥ä¸‹åŠŸèƒ½ï¼Œå¼€å§‹ä½ çš„å¿ƒç†è°ƒèŠ‚ä¹‹æ—…</p>

                <!-- ä¸‰ä¸ªåŠŸèƒ½å¡ç‰‡ï¼ˆä¸ä¹‹å‰ç›¸åŒï¼‰ -->
                <div class="grid md:grid-cols-3 gap-8">
                    <!-- å‘¼å¸å¼•å¯¼å¡ç‰‡ -->
                    <a href="./breathing.html" class="block bg-gradient-to-br from-blue-50 to-indigo-50 p-8 rounded-3xl hover:shadow-xl transition border-2 border-transparent hover:border-indigo-300">
                        <div class="text-5xl mb-4">ğŸŒ¬ï¸</div>
                        <h2 class="text-2xl font-bold text-indigo-700 mb-2">æƒ…ç»ªè°ƒèŠ‚å™¨</h2>
                        <p class="text-gray-700 mb-4">4-4-6å‘¼å¸æ³• Â· åŠ¨ç”»å¼•å¯¼ Â· è¯­éŸ³é™ªä¼´</p>
                        <span class="inline-block bg-indigo-600 text-white px-6 py-2 rounded-full text-sm font-semibold">å¼€å§‹å‘¼å¸ â†’</span>
                    </a>

                    <!-- å¿ƒç†æµ‹è¯„å¡ç‰‡ -->
                    <a href="./assessment.html" class="block bg-gradient-to-br from-green-50 to-emerald-50 p-8 rounded-3xl hover:shadow-xl transition border-2 border-transparent hover:border-emerald-300">
                        <div class="text-5xl mb-4">ğŸ“‹</div>
                        <h2 class="text-2xl font-bold text-emerald-700 mb-2">å¿ƒç†çŠ¶æ€æµ‹è¯„</h2>
                        <p class="text-gray-700 mb-4">10é¢˜ä¸“ä¸šç­›æŸ¥ Â· å³æ—¶ç»“æœ Â· æ”¹å–„å»ºè®®</p>
                        <span class="inline-block bg-emerald-600 text-white px-6 py-2 rounded-full text-sm font-semibold">å¼€å§‹æµ‹è¯„ â†’</span>
                    </a>

                    <!-- å†¥æƒ³å®¤å¡ç‰‡ -->
                    <a href="./meditation.html" class="block bg-gradient-to-br from-purple-50 to-violet-50 p-8 rounded-3xl hover:shadow-xl transition border-2 border-transparent hover:border-purple-300">
                        <div class="text-5xl mb-4">ğŸ§˜</div>
                        <h2 class="text-2xl font-bold text-purple-700 mb-2">å†¥æƒ³å®¤</h2>
                        <p class="text-gray-700 mb-4">5/10/15åˆ†é’Ÿ Â· æ²‰æµ¸è®¡æ—¶ Â· æ”¾æ¾è®°å½•</p>
                        <span class="inline-block bg-purple-600 text-white px-6 py-2 rounded-full text-sm font-semibold">è¿›å…¥å†¥æƒ³ â†’</span>
                    </a>
                </div>
            </div>

            <!-- è®¾ç½®å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼‰ -->
            <div id="settingsContainer" style="display: none;">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">è´¦æˆ·è®¾ç½®</h2>
                <div class="bg-white rounded-2xl shadow-sm p-8 max-w-md">
                    <form id="settingsForm" class="settings-form space-y-6">
                        <!-- ä¿®æ”¹ç”¨æˆ·å -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ–°ç”¨æˆ·å</label>
                            <input type="text" id="newUsername" placeholder="è¾“å…¥æ–°ç”¨æˆ·å" value="">
                            <p class="text-xs text-gray-500 mt-1">ä¿®æ”¹åå·¦ä¾§ç”¨æˆ·åå°†ç«‹å³æ›´æ–°</p>
                        </div>
                        <!-- ä¿®æ”¹å¯†ç  -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">æ–°å¯†ç </label>
                            <input type="password" id="newPassword" placeholder="è¾“å…¥æ–°å¯†ç ">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ç¡®è®¤æ–°å¯†ç </label>
                            <input type="password" id="confirmPassword" placeholder="å†æ¬¡è¾“å…¥æ–°å¯†ç ">
                        </div>
                        <div class="flex gap-4 pt-4">
                            <button type="button" id="saveUsernameBtn" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">ä¿å­˜ç”¨æˆ·å</button>
                            <button type="button" id="savePasswordBtn" class="bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition">ä¿®æ”¹å¯†ç </button>
                        </div>
                    </form>

                    <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
                    <div class="mt-8 border-t pt-6">
                        <button type="button" id="logoutBtn" class="w-full bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition flex items-center justify-center gap-2">
                            <span>ğŸšª</span> é€€å‡ºç™»å½•
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        (function() {
            // ä» localStorage è¯»å–ç™»å½•çŠ¶æ€
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            let username = localStorage.getItem('username') || '';

            // æœªç™»å½•åˆ™è·³è½¬å›ç™»å½•é¡µï¼ˆå‡è®¾ç™»å½•é¡µæ˜¯ index.htmlï¼‰
            if (!isLoggedIn) {
                window.location.href = './index.html';
                return;
            }

            // æ˜¾ç¤ºç”¨æˆ·å
            const usernameDisplay = document.getElementById('usernameDisplay');
            usernameDisplay.textContent = username || 'ç”¨æˆ·';

            // è®¾ç½®è¡¨å•ä¸­çš„ç”¨æˆ·åè¾“å…¥æ¡†é»˜è®¤å€¼
            const newUsernameInput = document.getElementById('newUsername');
            if (newUsernameInput) newUsernameInput.value = username;

            // è·å–å…ƒç´ 
            const toolsContainer = document.getElementById('toolsContainer');
            const settingsContainer = document.getElementById('settingsContainer');
            const toolsNavBtn = document.getElementById('toolsNavBtn');
            const settingsBtn = document.getElementById('settingsBtn');
            const signinBtn = document.getElementById('signinBtn');
            // ========== æ–°å¢è·å–è¿”å›å¯¹è¯æŒ‰é’® ==========
            const backToIndexBtn = document.getElementById('backToIndexBtn');
            // ========== æ–°å¢ç»“æŸ ==========

            // å¯¼èˆªæ¿€æ´»çŠ¶æ€åˆ‡æ¢
            function setActiveNav(activeId) {
                [toolsNavBtn, settingsBtn, backToIndexBtn].forEach(btn => {
                    if (btn) btn.classList.remove('active', 'bg-indigo-100', 'text-indigo-800');
                });
                if (activeId === 'tools') {
                    toolsNavBtn.classList.add('active', 'bg-indigo-100', 'text-indigo-800');
                } else if (activeId === 'settings') {
                    settingsBtn.classList.add('active', 'bg-indigo-100', 'text-indigo-800');
                }
                // è¿”å›å¯¹è¯æŒ‰é’®ä¸å‚ä¸æ¿€æ´»æ ·å¼ï¼Œä½†ä¹Ÿå¯ä»¥ä¿ç•™æ ·å¼ï¼Œè¿™é‡Œä¸å¤„ç†
            }

            // æ˜¾ç¤ºå·¥å…·å¡ç‰‡
            function showTools() {
                toolsContainer.style.display = 'block';
                settingsContainer.style.display = 'none';
                setActiveNav('tools');
            }

            // æ˜¾ç¤ºè®¾ç½®
            function showSettings() {
                toolsContainer.style.display = 'none';
                settingsContainer.style.display = 'block';
                setActiveNav('settings');
            }

            // ç»‘å®šå¯¼èˆªç‚¹å‡»
            toolsNavBtn.addEventListener('click', showTools);
            settingsBtn.addEventListener('click', showSettings);

            // ========== ç»‘å®šè¿”å›å¯¹è¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶ ==========
            backToIndexBtn.addEventListener('click', function() {
                // ç›´æ¥è·³è½¬åˆ° index.htmlï¼ˆç™»å½•é¡µï¼‰
                window.location.href = './index.html';
            });
            // ========== æ–°å¢ç»“æŸ ==========

            // æ¯æ—¥ç­¾åˆ°æŒ‰é’®ï¼šè·³è½¬åˆ°ç­¾åˆ°é¡µé¢ï¼ˆå¯è‡ªè¡Œåˆ›å»º signin.htmlï¼‰
            signinBtn.addEventListener('click', function() {
                window.location.href = './signin.html';
            });

            // ä¿å­˜ç”¨æˆ·å
            document.getElementById('saveUsernameBtn').addEventListener('click', function() {
                const newName = newUsernameInput.value.trim();
                if (!newName) {
                    alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º');
                    return;
                }
                // ç®€å•æ¨¡æ‹Ÿæ›´æ–°
                localStorage.setItem('username', newName);
                usernameDisplay.textContent = newName;
                alert('ç”¨æˆ·åå·²æ›´æ–°ï¼');
                // å¯åœ¨æ­¤æ·»åŠ è°ƒç”¨çœŸå®APIçš„ä»£ç 
            });

            // ä¿®æ”¹å¯†ç 
            document.getElementById('savePasswordBtn').addEventListener('click', function() {
                const newPwd = document.getElementById('newPassword').value;
                const confirmPwd = document.getElementById('confirmPassword').value;
                if (!newPwd || !confirmPwd) {
                    alert('è¯·è¾“å…¥å¯†ç ');
                    return;
                }
                if (newPwd !== confirmPwd) {
                    alert('ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´');
                    return;
                }
                // æ¨¡æ‹ŸæˆåŠŸï¼ˆå®é™…åº”è¯·æ±‚APIï¼‰
                alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            });

            // é€€å‡ºç™»å½•æŒ‰é’®äº‹ä»¶
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('username');
                    window.location.href = './index.html';
                }
            });

            // é»˜è®¤é€‰ä¸­å·¥å…·å¯¼èˆª
            showTools();
        })();
    </script>
</body>
</html>